<header class="header" data-header>
  <div class="header__inner">
    <a href="{{ routes.root_url }}" class="header__logo">
      {{ section.settings.logo_text | default: shop.name }}
    </a>

    <nav class="header__nav" id="nav-menu" aria-label="Hauptnavigation">
      {% for link in section.settings.menu.links %}
        <a href="{{ link.url }}" class="header__link {% if link.active %}header__link--active{% endif %}">
          {{ link.title }}
        </a>
      {% endfor %}
    </nav>

    <div class="header__actions">
      <a href="{{ routes.cart_url }}" class="header__cart" aria-label="Warenkorb">
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="1.5">
          <path d="M5 7h10l-1.5 8H6.5L5 7z"/>
          <path d="M7.5 7V5a2.5 2.5 0 0 1 5 0v2"/>
        </svg>
        {% if cart.item_count > 0 %}
          <span class="header__cart-count">{{ cart.item_count }}</span>
        {% endif %}
      </a>

      <button class="header__burger" aria-label="MenÃ¼" aria-expanded="false" aria-controls="nav-menu" data-burger>
        <span></span>
        <span></span>
      </button>
    </div>
  </div>
</header>

<script>
  (function() {
    var burger = document.querySelector('[data-burger]');
    var nav = document.getElementById('nav-menu');
    var header = document.querySelector('[data-header]');

    if (!burger || !nav) return;

    burger.addEventListener('click', function() {
      var isOpen = burger.getAttribute('aria-expanded') === 'true';
      burger.setAttribute('aria-expanded', String(!isOpen));
      nav.classList.toggle('header__nav--open');
      header.classList.toggle('header--open');
      document.documentElement.style.overflow = isOpen ? '' : 'hidden';
    });

    nav.querySelectorAll('.header__link').forEach(function(link) {
      link.addEventListener('click', function() {
        burger.setAttribute('aria-expanded', 'false');
        nav.classList.remove('header__nav--open');
        header.classList.remove('header--open');
        document.documentElement.style.overflow = '';
      });
    });
  })();
</script>

{% stylesheet %}
  .header {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: var(--z-header);
    transition: background-color var(--transition-base);
  }

  .header--scrolled,
  .header--open {
    background-color: var(--color-bg);
  }

  .header__inner {
    display: flex;
    align-items: center;
    justify-content: space-between;
    height: 4.5rem;
    padding: 0 var(--page-margin);
    max-width: var(--page-width);
    margin: 0 auto;
  }

  .header__logo {
    font-family: var(--font-heading);
    font-size: var(--text-sm);
    font-weight: 400;
    letter-spacing: 0.2em;
    text-transform: uppercase;
    text-decoration: none;
    color: var(--color-fg);
    z-index: 1;
  }

  .header__nav {
    display: flex;
    gap: var(--space-md);
  }

  .header__link {
    font-size: var(--text-xs);
    font-weight: 400;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    text-decoration: none;
    color: var(--color-fg);
    opacity: 0.7;
    transition: opacity var(--transition-base);
  }

  .header__link:hover,
  .header__link--active {
    opacity: 1;
  }

  .header__actions {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    z-index: 1;
  }

  .header__cart {
    position: relative;
    display: flex;
    align-items: center;
    color: var(--color-fg);
  }

  .header__cart-count {
    position: absolute;
    top: -6px;
    right: -8px;
    width: 16px;
    height: 16px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 10px;
    font-weight: 400;
    background-color: var(--color-fg);
    color: var(--color-bg);
    border-radius: 50%;
  }

  .header__burger {
    display: none;
    flex-direction: column;
    justify-content: center;
    gap: 5px;
    width: 24px;
    height: 24px;
    padding: 0;
  }

  .header__burger span {
    display: block;
    width: 100%;
    height: 1px;
    background-color: var(--color-fg);
    transition: transform var(--transition-base);
  }

  .header__burger[aria-expanded="true"] span:first-child {
    transform: translateY(3px) rotate(45deg);
  }

  .header__burger[aria-expanded="true"] span:last-child {
    transform: translateY(-3px) rotate(-45deg);
  }

  @media (max-width: 749px) {
    .header__nav {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: var(--space-lg);
      background-color: var(--color-bg);
      opacity: 0;
      pointer-events: none;
      transition: opacity var(--transition-base);
    }

    .header__nav--open {
      opacity: 1;
      pointer-events: all;
    }

    .header__nav--open .header__link {
      font-size: var(--text-xl);
      opacity: 1;
    }

    .header__burger {
      display: flex;
    }
  }
{% endstylesheet %}

{% schema %}
{
  "name": "Kopfzeile",
  "settings": [
    {
      "type": "text",
      "id": "logo_text",
      "label": "Logo-Text",
      "default": "Laura Messerschmitt"
    },
    {
      "type": "link_list",
      "id": "menu",
      "label": "Navigation",
      "default": "main-menu"
    }
  ]
}
{% endschema %}
